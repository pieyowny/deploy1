<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Share Pertanyaan</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="{{ url_for('static', filename='script.js') }}" defer></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Ambil kode pertanyaan dari URL path
            const pathSegments = window.location.pathname.split('/');
            const kode = pathSegments[pathSegments.length - 1];

            // 1. TAMBAH STATE untuk mendeteksi Back
            history.pushState(null, null, location.href);

            window.onpopstate = function() {
                // 2. Tampilkan notifikasi konfirmasi
                const confirmLogout = confirm("Apakah anda yakin ingin ke halaman sebelumnya? Sesi akses akan ditutup.");

                if (confirmLogout) {
                    // 3. Jika YAKIN, hapus sesi di server
                    fetch(`/delete_session/${kode}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    })
                    .then(response => {
                        // 4. Lakukan navigasi kembali ke halaman sebelumnya
                        window.history.back();
                    })
                    .catch(error => {
                        console.error('Error saat menghapus sesi:', error);
                        window.history.back();
                    });
                } else {
                    // 5. Jika TIDAK YAKIN/DIBATALKAN, kunci tombol Back
                    history.go(1); 
                }
            };
        });
    </script>
</head>
<body>

<div class="card">
Â  <h2>Yeayy.. Pertanyaan Siap Dibagikan!</h2>
Â  <p>ğŸ’Œ Link menjawab:</p>

Â  <a id="linkJawab" href="{{ link }}">{{ link }}</a>
Â  <button class="btn-blue" onclick="copyText('linkJawab')">Copy Link</button>

Â  <hr style="margin: 20px 0;">

Â  <p>ğŸ”’ Akses Jawaban Anda (Khusus Pembuat Pertanyaan):</p>
    Â  <a href="{{ url_for('lihat_jawaban', kode=kode, token=temp_token) }}">
Â  Â  <button class="btn-pink">Lihat Jawaban Saya ğŸ” (Sesi Ini Saja)</button>
Â  </a>
Â 
Â  <button class="btn-gray" onclick="location.href='/home'">Home</button>
</div>

</body>
</html>